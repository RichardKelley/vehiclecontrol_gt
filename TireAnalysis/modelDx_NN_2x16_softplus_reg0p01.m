function [ACCX,ACCY,ACCROTZ] = modelDx_NN_2x16_softplus_reg0p01(VELX,VELY,VELROTZ,BETA,AB,TV, param)
    %param = [B1,C1,D1,B2,C2,D2,Ic];
    B1 = param(1);
    C1 = param(2);
    D1 = param(3);
    B2 = param(4);
    C2 = param(5);
    D2 = param(6);
    Ic = param(7);
    %maxA = param(8);
    magic = @(s,B,C,D)D.*sin(C.*atan(B.*s));
    reg = 0.5;
    capfactor = @(taccx)(1-satfun((taccx/D2)^2))^(1/2);
    simpleslip = @(VELY,VELX,taccx)-(1/capfactor(taccx))*VELY/(VELX+reg);
    %simpleslip = @(VELY,VELX,taccx)-VELY/(VELX+reg);
    simplediraccy = @(VELY,VELX,taccx)magic(simpleslip(VELY,VELX,taccx),B2,C2,D2);
    simpleaccy = @(VELY,VELX,taccx)capfactor(taccx)*simplediraccy(VELY,VELX,taccx);
    %acclim = @(VELY,VELX, taccx)(VELX^2+VELY^2)*taccx^2-VELX^2*maxA^2;
    simplefaccy = @(VELY,VELX)magic(-VELY/(VELX+reg),B1,C1,D1);
    %simpleaccy = @(VELY,VELX,taccx)magic(-VELY/(VELX+reg),B2,C2,D2);



    l = 1.19;
    l1 = 0.73;
    l2 = l-l1;
    f1n = l2/l;
    f2n = l1/l;
    w = 1;
    rotmat = @(beta)[cos(beta),sin(beta);-sin(beta),cos(beta)];
    vel1 = rotmat(BETA)*[VELX;VELY+l1*VELROTZ];
    f1y = simplefaccy(vel1(2),vel1(1));
    F1 = rotmat(-BETA)*[0;f1y]*f1n;
    F1x = F1(1);
    F1y = F1(2);
    frontabcorr = F1x;
    F2x = AB;
    F2y1 = simpleaccy(VELY-l2*VELROTZ,VELX,(AB+TV/2)/f2n)*f2n/2;
    F2y2 = simpleaccy(VELY-l2*VELROTZ,VELX,(AB-TV/2)/f2n)*f2n/2;
    F2y = simpleaccy(VELY-l2*VELROTZ,VELX,AB/f2n)*f2n;
    TVTrq = TV*w;
    
    
    ACCROTZ_NOM = (TVTrq + F1y*l1 -F2y*l2)/Ic;
    %ACCROTZ = TVTrq + F1y*l1;
    ACCX_NOM = F1x+F2x+VELROTZ*VELY;
    ACCY_NOM = F1y+F2y1+F2y2-VELROTZ*VELX;
    
    w1 = [-0.08108348 -0.08108023 0.6420934 -1.3078041 -0.08108021 -1.4592927 -0.7492146 -0.08108024 -0.081090756 0.5228035 -0.08107428 -0.081081636 0.6560095 -0.08107705 -0.081084944 0.8856307;0.0033039427 0.0033015904 0.06475778 -0.091712475 0.0033016102 0.24448985 -2.6516266 0.003301612 0.0033093665 -0.197205 0.0032976896 0.0033026794 0.033960346 0.0032995425 0.0033050915 -0.16211753;-0.003469492 -0.0034643887 0.63911647 -0.51170355 -0.0034644192 0.14363733 1.1230304 -0.003464468 -0.00348116 -0.4426252 -0.0034553502 -0.003466757 0.8349656 -0.0034593898 -0.0034718404 -0.75110805;-0.015199126 -0.015197268 -0.6741022 -0.19570604 -0.015197288 0.55898553 0.048800405 -0.015197275 -0.015203436 -0.27389178 -0.0151943425 -0.015198177 0.34828466 -0.015195702 -0.015200047 1.0336523;-0.07274612 -0.07273447 -0.14013526 0.01684434 -0.072734565 0.033899404 -0.034585588 -0.07273462 -0.07277302 0.20681413 -0.07271444 -0.07273984 0.11433748 -0.072723635 -0.0727517 -0.12977068;0.03355485 0.033545192 -0.48886552 0.41494006 0.033545267 -0.6467404 0.2643397 0.033545338 0.03357694 -0.47862655 0.033528235 0.03354958 0.5742577 0.033536017 0.033559345 -0.03213619];
    b1 = [0.060034662 0.06003193 0.4154631 0.5117456 0.06003194 0.6356099 0.3934157 0.06003195 0.060040977 0.1846951 0.060027078 0.06003316 0.21036628 0.0600293 0.060035974 0.4022084];
    w2 = [-0.0033458632 -0.003345863 0.10907049 -0.0033458648 -0.003345864 -0.0033458653 0.19640423 0.14706904 0.08372413 -0.0033458634 0.110337794 -0.0033458641 0.030034218 -0.0033458637 0.047787752 -0.0033458641;-0.0033450306 -0.0033450297 0.109072976 -0.0033450304 -0.003345031 -0.0033450313 0.19639333 0.14705516 0.08373448 -0.0033450308 0.11033885 -0.0033450297 0.030031547 -0.0033450334 0.04778751 -0.0033450297;-0.014441482 -0.014441484 0.57231313 -0.014441479 -0.014441476 -0.014441479 0.42725772 -0.66555214 0.18364978 -0.014441475 -0.041713614 -0.014441485 0.7127341 -0.014441477 0.015967958 -0.0144414855;-0.0061478703 -0.0061478717 -0.40349534 -0.006147864 -0.0061478685 -0.006147872 0.5990928 0.9359806 -0.35324857 -0.006147866 0.6679026 -0.0061478713 -0.35302237 -0.0061478713 0.23866688 -0.006147869;-0.0033450366 -0.0033450383 0.10907293 -0.0033450392 -0.003345037 -0.003345038 0.1963934 0.14705527 0.083734386 -0.0033450376 0.11033884 -0.0033450357 0.0300316 -0.0033450385 0.047787514 -0.0033450366;0.01854329 0.018543284 0.41182008 0.018543262 0.018543277 0.018543288 0.67290366 -0.0781889 0.71342796 0.018543279 1.0082955 0.018543288 -0.92783123 0.018543275 -0.14367831 0.018543288;0.0025219363 0.0025219375 -0.10435 0.0025219177 0.002521933 0.0025219326 -1.5182819 0.44030285 0.6367199 0.0025219314 -1.6261164 0.0025219345 0.59744847 0.0025219303 -0.3534833 0.0025219354;-0.0033450406 -0.0033450394 0.10907292 -0.003345042 -0.0033450413 -0.0033450425 0.1963934 0.14705537 0.08373434 -0.0033450422 0.11033885 -0.0033450401 0.030031594 -0.0033450418 0.047787514 -0.0033450406;-0.0033477927 -0.003347792 0.1090649 -0.0033477948 -0.0033477931 -0.0033477948 0.19642933 0.14710091 0.08370043 -0.0033477934 0.11033567 -0.0033477934 0.030040428 -0.0033477931 0.047788266 -0.0033477934;0.020744782 0.020744782 0.62389374 0.020744763 0.020744769 0.020744782 -0.15771648 -0.2031742 0.46902478 0.020744774 -0.20775446 0.02074478 -0.023193555 0.020744773 -0.1218207 0.020744782;-0.0033435998 -0.0033435994 0.109077506 -0.0033436012 -0.0033435973 -0.0033435982 0.19637467 0.14703035 0.083752036 -0.0033435966 0.11033971 -0.0033435975 0.030027196 -0.0033435994 0.047787033 -0.0033435982;-0.0033454173 -0.0033454178 0.109071836 -0.0033454164 -0.0033454166 -0.003345417 0.19639827 0.14706153 0.08372965 -0.0033454164 0.1103381 -0.003345417 0.030032787 -0.0033454178 0.04778761 -0.0033454173;0.0035498748 0.0035498757 -0.61924905 0.0035498776 0.003549871 0.003549876 -0.012769924 0.3109007 -0.07564129 0.0035498764 -0.066610195 0.0035498766 0.72063965 0.0035498764 0.4618288 0.0035498748;-0.0033442567 -0.0033442553 0.109075405 -0.0033442557 -0.0033442553 -0.0033442553 0.19638342 0.14704148 0.08374391 -0.0033442557 0.11033945 -0.0033442557 0.030029193 -0.0033442543 0.047787264 -0.0033442567;-0.003346268 -0.003346265 0.10906935 -0.0033462662 -0.0033462672 -0.0033462662 0.19640946 0.14707547 0.083719306 -0.0033462665 0.11033722 -0.0033462672 0.030035531 -0.003346268 0.04778787 -0.0033462674;0.006315905 0.006315907 0.09327245 0.0063158977 0.006315901 0.006315903 -0.5701149 0.9997683 0.10676252 0.006315901 -0.4958216 0.0063159047 -0.34696022 0.0063158963 0.1797367 0.0063159056];
    b2 = [0.0019190833 0.0019190845 0.17414118 0.0019190778 0.001919081 0.0019190842 0.20479263 0.13909444 0.15884793 0.0019190813 0.128331 0.0019190832 0.052712966 0.0019190796 0.07703419 0.001919083];
    w3 = [-0.053979293 -0.04184263 0.010325582;-0.053979293 -0.041842647 0.010325584;0.15829594 -0.4058826 1.0208197;-0.053979278 -0.041842572 0.010325562;-0.05397927 -0.041842617 0.010325585;-0.053979293 -0.041842625 0.010325588;0.23219232 1.6275744 0.6017693;0.09793142 -0.81977695 -1.353459;-0.1332843 -0.7644031 0.7409596;-0.053979285 -0.041842613 0.010325586;-0.16222636 1.7796459 0.49611577;-0.053979293 -0.041842636 0.010325585;0.11340524 1.2883725 0.18816714;-0.053979285 -0.041842602 0.010325587;-0.10011164 0.29694095 -0.52039576;-0.053979293 -0.041842632 0.010325582];
    b3 = [-0.06479154 -0.059893847 0.01003392];
    means = [2.6775749832578986 0.001922168301437502 -0.04515304867653743 -0.026195759869689427 0.06460829512732788 -0.0686602322088558];
    stds = [1.907241556285694 0.3079627568782051 0.5515613235298231 0.20101736434516326 0.8309067855283836 0.634574245360539];
    
    input = [VELX,VELY,VELROTZ,BETA,AB,TV];

    normed_input = (input - means) ./ stds;

    h1 = log(exp(normed_input * w1 + b1) + 1);
    h2 = log(exp(h1 * w2 + b2) + 1);
    disturbance = h2 * w3 + b3;
    
    ACCX = ACCX_NOM + disturbance(1);
    ACCY = ACCY_NOM + disturbance(2);
    ACCROTZ = ACCROTZ_NOM + disturbance(3);
end

