function [ACCX,ACCY,ACCROTZ] = kinematic_model(VELX,VELY,VELROTZ,BETA,AB,TV)
    c = 1.19/tan(BETA);

    VELROTZ_T = VELX/c;
    k = 2.2;

    dVELROTZ = k * (VELROTZ_T - VELROTZ);
    
    ACCX_NOM = AB;
    ACCY_NOM = 0;
    ACCROTZ_NOM = dVELROTZ;
    
    w1 = [-1.5291319 -0.36460513 -0.43657476 1.2882086 0.46577233 0.11513422 0.12454785 0.33777165 0.023451535 -1.3722359 0.64887357 0.76912045 1.1484739 -0.34209663 0.5113726 0.740904;0.9676245 -0.0651941 0.49872172 0.5252089 -0.33441147 0.023881968 -0.41573593 0.2114189 -0.42585742 -0.26255518 -0.08623019 0.74963933 1.3412007 0.23478551 0.4179893 -0.62353384;0.15206453 -0.56434536 0.5396656 1.4722742 -0.24139567 0.103906974 0.8265276 -1.2914597 1.071042 0.30409572 0.13545816 0.2040113 -0.81452787 -0.25320384 0.15273966 0.27709377;-0.16434437 -0.47678158 -0.5012988 -1.1573768 0.5045369 -0.47284546 -0.094872326 -0.53471345 -0.34280092 0.35062784 -0.6278157 -1.1912856 0.97014564 -0.1870021 0.37079614 0.8068314;0.29795766 -0.50833476 0.2265275 -0.031584997 -0.78241754 -0.12456985 0.49886954 0.20607944 -0.2919445 -0.15201847 0.41056278 -0.13414003 0.22822453 0.07291 0.20203371 0.62279326;0.08351974 0.42836457 0.39113346 -0.039513398 -0.18754256 0.07121416 -0.8214613 0.69336975 0.25827974 0.1237286 -0.15139489 -0.1872202 -0.23754452 -0.27876872 0.7243281 0.10883507];
    b1 = [1.379434 0.06971247 0.7728353 -0.6672019 -0.097189456 1.4261268 -0.19194716 -0.22359957 -0.62097365 1.0429665 0.6450712 -0.76165855 0.01947427 0.5363404 0.21733855 0.01938477];
    w2 = [-0.07665264 -0.3312208 0.52277553 -0.06322699 -0.821494 0.2523593 -0.19684361 0.53851664 0.06327417 0.46580917 -1.3511946 -0.2115294 -0.5658268 -0.42786485 -0.92496747 -0.104141705;-0.17479178 0.08446675 0.19897394 -0.21763863 -0.18182515 0.08864524 -0.075359136 -0.260032 0.60985583 0.54336876 0.28887904 -0.049289808 -0.4417343 -0.18624091 -0.31121275 0.32247415;0.7587819 -0.6367877 0.0993988 0.016725468 0.010305615 0.25692973 -0.07019252 -0.52465713 -0.08585612 0.2404451 -0.34250918 -0.38335842 -0.20167647 -0.3217884 -0.12154969 -0.23944452;0.31733793 -0.63966995 -0.375033 0.7160908 0.23196755 0.37036276 -0.049605142 -0.16011788 -0.8437419 0.25453454 -0.33690432 0.30697107 0.85075295 -0.40604997 -0.79123193 0.42116913;-0.17719719 0.64042926 0.034421366 -0.03279375 0.14043619 -0.0934224 -0.11095662 -0.20586464 -0.5376925 0.16532144 0.21610402 0.09219898 0.35152635 0.05239694 -0.09823531 0.5421005;0.741643 -0.468464 0.26660454 -0.13450967 0.17591828 0.30848718 0.49506077 -0.65238404 0.61998194 -0.2515601 0.625389 -0.13278951 -0.65526867 -0.3564472 0.3990152 0.21085589;0.19917235 -0.23007749 0.11333547 0.61969614 -0.6468487 -0.10025765 -0.47464526 0.24429728 0.044347595 0.15266709 -0.16858691 0.20678292 0.051127397 0.04235785 0.6082011 0.02748343;-0.45812413 0.15491395 -0.018626029 -0.01715906 -0.34301543 0.051961817 -0.3576023 0.65486306 0.16048408 -0.80214745 -0.35197887 -0.18929265 -0.507326 0.5871706 -0.41463116 -0.0023559153;0.12465782 -0.23813108 0.13820608 -0.028523117 0.18731275 -0.27446046 -0.2261248 0.36806118 -0.30647236 -0.3893982 -0.26428092 -0.62726074 0.6755326 -0.17614043 0.45967266 -0.22887358;0.27033722 -0.54889095 0.13514438 -0.30425116 -0.68750334 -0.20249175 -0.43788454 0.22082138 -0.5738594 0.5877649 -0.22960544 -0.3485344 -0.8847965 -0.1593801 -0.3124003 0.18635452;0.6692643 0.073700406 -0.03294008 0.2655192 -0.23233162 0.68525773 0.2624921 -0.34953162 0.45080122 -0.22234283 0.17584482 0.26513553 -0.3615195 0.033327445 0.17120048 0.099385194;0.34893015 0.15679352 0.18309703 0.07708184 -0.06403471 0.018566526 -0.21226488 0.013905912 -0.84776324 -0.29843608 -0.3046983 -0.114214495 0.096419156 0.23188458 -0.70061785 -0.18996572;-0.82412386 0.5500946 -0.67887414 -0.98986006 0.35231316 0.29410645 0.1634624 0.26443 0.20498024 -5.4315555e-05 0.48220432 0.49026877 0.44153142 0.2550077 -0.4105851 -0.6097611;0.12422155 -0.27802312 0.2458645 -0.19111389 -0.28940928 0.27525833 0.2948483 0.109541155 0.25423342 -0.26654756 0.24256045 0.13735461 -0.3823786 -0.21613993 -0.4288206 -0.25825664;-0.07345701 -0.21713631 -0.4562462 -0.10640732 0.84408504 0.03491301 0.13241078 -0.011788206 0.011573849 -0.10285353 0.18962888 0.037642106 0.38600037 0.10372002 0.012122478 0.04888803;-0.2109248 0.3505406 -0.12766612 0.32753497 -0.24298722 -0.7789861 -0.30685398 0.06048123 0.56491244 -0.020278232 0.12915792 0.30613226 0.17120878 0.22016743 0.5059338 -0.16050851];
    b2 = [0.46230954 -0.35531306 0.057566095 -0.34211773 0.39802542 0.24606262 0.37629092 -0.42593503 0.36345318 -0.03585805 1.0747391 0.115504526 -0.630202 -0.28717756 0.17397717 0.1415053];
    w3 = [-0.17550875 -1.007708 -0.014198617 0.20441774 -0.35737726 0.4370081 0.18373366 0.20630118 0.13864703 -1.0173993 -0.0017340895 -0.33343416 0.12164537 0.12042916 -0.20671864 0.17711106;-0.072652735 -0.35792983 0.20227964 -0.0025445565 0.7624038 -0.19501038 0.20429477 0.36957917 0.18188475 0.3972311 -0.45594782 -0.19758157 0.16999704 0.0438236 -0.04155992 0.43723717;-0.104668215 -0.5073024 0.22381721 0.37689006 0.017554263 -0.47078162 -0.5556227 -0.16934486 0.032803677 -0.08079542 -0.004149366 -0.044738397 0.05380875 -0.017824207 -0.08581604 0.03938655;-0.44823995 0.4734754 -0.03784825 -0.20348379 -0.095066205 0.46460003 -0.3474822 -0.0809858 0.01925352 -0.004374533 -0.30751875 -0.35120708 0.25761995 0.33049086 -0.070426 -0.33389714;0.28589314 0.61415243 -0.3684353 -0.03231423 0.2243518 -0.25552016 0.38007703 -0.27943975 -0.33056307 0.10630178 -0.073016725 0.65558815 -0.34405136 0.016776504 -0.04206451 0.14926708;-0.08359009 0.40474305 -0.044334184 -0.28815654 -0.026872993 0.07290204 0.1547668 0.16142093 0.02326908 -0.733504 0.094114624 -0.30639434 -0.5907292 -0.27982897 -0.17190452 -0.34459314;0.22117421 0.4085806 -0.06569091 -0.04174083 -0.2054742 0.13353947 -0.26704124 0.283882 0.07804766 -0.41238645 -0.19330665 0.4016076 -0.3345963 -0.11594816 -0.021176498 0.042468786;-0.1781138 0.08332077 0.28022492 0.5310491 -0.35847026 -0.22872774 -0.10780845 -0.23760074 0.21829227 -0.1400862 -0.42456955 0.14142112 0.7028307 0.23341441 -0.09851802 -0.17977934;0.6526834 0.44516763 -0.5589946 -0.058744844 -0.07121691 -0.48246536 -0.1574845 0.091304146 -0.5529847 0.47950995 0.62640375 0.40882716 -0.052808017 0.006517987 -0.0747409 -0.059234936;-0.68748593 -0.52128446 -0.26965523 -0.2813134 0.34724343 -0.06846566 -0.21598177 -0.053144563 -0.31375524 -0.21894339 0.31523275 -0.30041978 -0.4835588 -0.18603918 -0.054164845 0.26422146;0.6755389 0.027913306 0.22759959 0.18370453 -0.16984586 -0.08700869 0.41068435 0.037207022 0.15696137 0.65882134 0.118351825 1.0980564 0.48479047 -0.4397961 0.016681662 -0.19096711;0.07011477 -0.0074640955 0.26432258 -0.55479425 -0.23502915 -0.21335758 0.267522 0.265229 0.076062866 0.28602684 -0.30753627 0.137139 -0.15479957 -0.3280148 -0.03275562 -0.6961538;-0.09291742 0.4592547 -0.00825097 0.49365968 -0.2450237 -0.7735085 0.23764938 -0.67312104 -0.31808072 0.7384633 -0.13200347 -0.24583222 -0.61968607 0.36523077 -0.056797765 0.48294732;0.005611879 -0.24301456 0.14712998 0.090738095 -0.08449298 -0.012028428 0.26515242 -0.41705728 0.047957342 0.44030645 -0.22259632 -0.08464373 0.32493746 -0.03562914 -4.7810958e-05 -0.007707086;0.27652135 0.43899277 -0.1076829 0.21062885 -0.06618868 0.17174782 0.4589321 -0.75808823 -0.12217013 0.3536307 0.4874302 -0.2072094 0.23657562 0.41547027 -0.020766398 -0.1162287;-0.09196333 -0.19418126 0.09022371 -0.19618933 0.5289638 0.36846203 -0.12371643 0.19381022 0.2048293 0.01996806 0.1286316 -0.11797446 0.32508728 -0.25247943 -0.0210605 0.5760145];
    b3 = [0.08347056 -0.08060428 -0.06750284 -0.10599148 -0.29736176 0.18599363 -0.13850713 0.26011878 -0.014847442 -0.12478747 -0.011998093 0.24159014 -0.048840802 -0.3411929 -0.019684512 -0.11799668];
    w4 = [0.1009007 0.29816645 0.5022615;-0.104496695 -1.0270119 0.122388825;-0.42757446 0.13810022 -0.40909752;-0.70124465 -0.12867986 0.39611733;0.8595785 -0.038096644 -0.11702383;0.15991388 0.12589933 -0.64214283;0.22077891 0.55161923 0.11570466;0.14686227 -0.7899733 -0.24715431;-0.37386978 -0.021376409 -0.35076633;-0.029937688 0.13319033 -1.0766671;0.24375938 0.7586717 0.09651233;-0.16144885 -0.27942744 0.87650585;-0.40685123 0.7664059 -0.337426;-0.12992078 -0.3958881 0.5716082;-0.14627774 0.005174224 -0.08927878;0.3702292 -0.4037061 0.28461242];
    b4 = [-0.21141629 -0.02727607 -0.0955360];
    means = [2.66326668353954,0.08302773357105,0.368258326478095,0.166235053250688,0.061441704473481,0.424927556129753];
    stds = [1.90180318234532,0.288498583918729,0.404546822912991,0.115832943748584,0.825569901331786,0.478589027645236];
    
%     sign = BETA/abs(BETA);
    sign = tanh(BETA * 1000);
    input = [VELX,sign * VELY, sign * VELROTZ, sign * BETA,AB, sign * TV];
%     if BETA < 0
%         input = [VELX,-VELY,-VELROTZ,-BETA,AB,-TV];
%     else
%         input = [VELX,VELY,VELROTZ,BETA,AB,TV];
%     end

    normed_input = (input - means) ./ stds;
    
    h1 = log(exp(normed_input * w1 + b1) + 1);
    h2 = log(exp(h1 * w2 + b2) + 1);
    h3 = log(exp(h2 * w3 + b3) + 1);
    disturbance = h3 * w4 + b4;
    
    if BETA < 0
        disturbance(2) = -disturbance(2);
        disturbance(3) = -disturbance(3);
    end
    
    ACCX = ACCX_NOM + disturbance(1);
    ACCY = ACCY_NOM + disturbance(2);
    ACCROTZ = ACCROTZ_NOM + disturbance(3);
end

